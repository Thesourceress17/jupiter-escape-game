<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×¨×™×—×” ××›×•×›×‘ ×¦×“×§ - ××©×—×§ ×—×™× ×•×›×™</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(to bottom, #4c1d95, #000000);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fde047;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #d1d5db;
        }
        
        .board-container {
            background: #1f2937;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .board-title {
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .board {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }
        
        .board-row {
            display: flex;
            gap: 8px;
        }
        
        .board-square {
            width: 60px;
            height: 60px;
            border: 2px solid #4b5563;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            position: relative;
        }
        
        .square-start { background-color: #16a34a; }
        .square-end { background-color: #eab308; }
        .square-dilemma { background-color: #dc2626; }
        .square-normal { background-color: #374151; }
        
        .player-piece {
            position: absolute;
            bottom: 2px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 1px solid white;
        }
        
        .player-1 { background-color: #3b82f6; left: 4px; }
        .player-2 { background-color: white; left: 16px; border-color: #4b5563; }
        .player-3 { background-color: #22c55e; left: 28px; }
        .player-4 { background-color: #a855f7; left: 40px; }
        
        .warning-icon {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
        }
        
        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }
        
        .player-card {
            background: #1f2937;
            padding: 16px;
            border-radius: 8px;
            border: 2px solid #4b5563;
        }
        
        .player-active {
            border-color: #facc15;
            background: rgba(250, 204, 21, 0.1);
        }
        
        .player-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-bottom: 8px;
        }
        
        .scoreboard {
            background: linear-gradient(to right, #92400e, #c2410c);
            border: 2px solid #facc15;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .scoreboard-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #fde047;
            margin-bottom: 20px;
        }
        
        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
        }
        
        .score-card {
            background: rgba(55, 65, 81, 0.5);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .score-leader {
            background: rgba(250, 204, 21, 0.3);
            border: 2px solid #fde047;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .current-player {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .game-button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 8px;
        }
        
        .game-button:hover {
            background: #1d4ed8;
        }
        
        .game-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .bonus-button {
            background: #16a34a;
        }
        
        .bonus-button:hover {
            background: #15803d;
        }
        
        .dilemma-modal {
            background: rgba(0, 0, 0, 0.8);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .dilemma-content {
            background: #1f2937;
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .dilemma-title {
            color: #fca5a5;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }
        
        .card-button {
            background: #374151;
            border: 1px solid #4b5563;
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: right;
            cursor: pointer;
        }
        
        .card-selected {
            background: #2563eb;
            border-color: #60a5fa;
        }
        
        .hint-box {
            background: rgba(234, 88, 12, 0.3);
            border: 1px solid #ea580c;
            padding: 12px;
            border-radius: 8px;
            margin-top: 8px;
            font-size: 0.9rem;
        }
        
        .feedback-box {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .feedback-correct {
            background: rgba(34, 197, 94, 0.3);
            border: 1px solid #22c55e;
        }
        
        .feedback-partial {
            background: rgba(250, 204, 21, 0.3);
            border: 1px solid #facc15;
        }
        
        .feedback-wrong {
            background: rgba(239, 68, 68, 0.3);
            border: 1px solid #ef4444;
        }
        
        .game-log {
            background: #1f2937;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .log-entry {
            background: #374151;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }
        
        .rules {
            background: #1f2937;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        textarea {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            background: #374151;
            border: 1px solid #4b5563;
            color: white;
            resize: vertical;
            min-height: 80px;
        }
        
        .legend {
            text-align: center;
            margin-top: 16px;
            font-size: 0.9rem;
            color: #d1d5db;
        }
        
        @media (max-width: 768px) {
            .board-square {
                width: 45px;
                height: 45px;
                font-size: 10px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .players-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ×›×•×ª×¨×ª -->
        <div class="header">
            <h1 class="title">ğŸš€ ×‘×¨×™×—×” ××›×•×›×‘ ×¦×“×§</h1>
            <p class="subtitle">××©×—×§ ××¡×˜×¨×˜×’×™×” ×”× ×“×¡×™ ×œ×ª×œ××™×“×™× ×•×ª×œ××™×“×•×ª ×›×™×ª×” ×—'</p>
            <p style="font-size: 0.9rem; color: #9ca3af; margin-top: 8px;">×™×•×¦×¨ ×¢×œ ×™×“×™ Thesourceress17 ğŸ’«</p>
        </div>

        <!-- ×œ×•×— ×”××©×—×§ -->
        <div class="board-container">
            <h3 class="board-title">ğŸ›¤ï¸ ××¡×œ×•×œ ×”×‘×¨×™×—×” ××›×•×›×‘ ×¦×“×§</h3>
            <div class="board" id="gameBoard">
                <!-- ×”×œ×•×— ×™×™×‘× ×” ×‘-JavaScript -->
            </div>
            <div class="legend">
                ğŸ ×”×ª×—×œ×” | âš ï¸ ×“×™×œ××” ×”× ×“×¡×™×ª | ğŸ¯ ×©×™×’×•×¨ ××•×¦×œ×—!
            </div>
        </div>

        <!-- ××™×“×¢ ×©×—×§× ×™× -->
        <div class="players-grid" id="playersInfo">
            <!-- ××™×“×¢ ×”×©×—×§× ×™× ×™×™×‘× ×” ×‘-JavaScript -->
        </div>

        <!-- ×œ×•×— × ×™×§×•×“ -->
        <div class="scoreboard">
            <h3 class="scoreboard-title">ğŸ† ×œ×•×— ×”× ×™×§×•×“ ğŸ†</h3>
            <div class="score-grid" id="scoreBoard">
                <!-- ×œ×•×— ×”× ×™×§×•×“ ×™×™×‘× ×” ×‘-JavaScript -->
            </div>
        </div>

        <!-- ×¤×§×“×™× -->
        <div class="controls" id="gameControls">
            <!-- ×”×¤×§×“×™× ×™×™×‘× ×• ×‘-JavaScript -->
        </div>

        <!-- ×™×•××Ÿ ×”××©×—×§ -->
        <div class="game-log">
            <h3 style="margin-bottom: 12px;">ğŸ“– ×™×•××Ÿ ×”××©×—×§</h3>
            <div id="gameLog">
                <div class="log-entry">×”××©×—×§ ×”×ª×—×™×œ! ×‘×”×¦×œ×—×”!</div>
            </div>
        </div>

        <!-- ×›×œ×œ×™ ×”××©×—×§ -->
        <div class="rules">
            <h3 style="margin-bottom: 16px;">ğŸ“‹ ×›×œ×œ×™ ×”××©×—×§</h3>
            <div style="font-size: 0.9rem; line-height: 1.6;">
                <p style="margin-bottom: 8px;"><strong>××˜×¨×”:</strong> ×œ×”×™×•×ª ×”×¨××©×•×Ÿ ×œ×”×’×™×¢ ×œ××©×‘×¦×ª 24 - ×©×™×’×•×¨ ××•×¦×œ×— ××›×•×›×‘ ×¦×“×§!</p>
                <p style="margin-bottom: 8px;"><strong>××™×š ××©×—×§×™×:</strong> 1ï¸âƒ£ ×œ×•×—×¦×™× "×”×˜×œ ×§×•×‘×™×™×” ×•×–×•×–" â† 2ï¸âƒ£ ×”×©×—×§×Ÿ ×–×– ××•×˜×•××˜×™×ª â† 3ï¸âƒ£ ×× × ×—×ª×ª ×¢×œ ××©×‘×¦×ª ××“×•××”, ×¤×•×ª×¨×™× ×“×™×œ××”</p>
                <p style="margin-bottom: 8px;"><strong>×ª×•×¨ ×‘×•× ×•×¡:</strong> ×× ×¤×ª×¨×ª ×“×™×œ××” × ×›×•×Ÿ - ××§×‘×œ×ª ×ª×•×¨ × ×•×¡×£! ×”×›×¤×ª×•×¨ ×™×”×¤×•×š ×œ×™×¨×•×§ ×•×ª×•×›×œ×™ ×œ×”×˜×™×œ ×©×•×‘!</p>
                <p style="margin-bottom: 8px;"><strong>×“×™×œ××•×ª:</strong> ××©×‘×¦×•×ª ××“×•××•×ª ×¢× âš ï¸ (×™×© 10 ×›××œ×”!) ×“×•×¨×©×•×ª ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª ×”× ×“×¡×™×•×ª</p>
                <p style="margin-bottom: 8px;"><strong>×¨××–×™×:</strong> ×œ×•×—×¦×™× ×¢×œ ×›×¤×ª×•×¨ ×”×¨××– ×œ×¢×–×¨×” (××•×¨×™×“×™× 1 × ×§×•×“×”)</p>
                <p><strong>× ×™×§×•×“:</strong> ×ª×©×•×‘×” ××¦×•×™× ×ª = ×ª×•×¨ ×‘×•× ×•×¡ + 3 ×¦×¢×“×™ ×§×“×™××” + × ×§×•×“×•×ª</p>
            </div>
        </div>

        <!-- ×›×¤×ª×•×¨ ××™×¤×•×¡ -->
        <div style="text-align: center; border-top: 1px solid #4b5563; padding-top: 20px;">
            <h4 style="margin-bottom: 8px;">ğŸ”„ ×”×ª×—×œ×” ××—×“×©</h4>
            <p style="font-size: 0.9rem; color: #9ca3af; margin-bottom: 16px;">×¨×§ ×× ××ª× ×¨×•×¦×™× ×œ×”×ª×—×™×œ ××©×—×§ ×—×“×© ×œ×—×œ×•×˜×™×Ÿ</p>
            <button onclick="resetGame()" style="background: #dc2626; color: white; border: none; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer;">
                ğŸ”„ ××™×¤×•×¡ ××œ× - ××©×—×§ ×—×“×©
            </button>
        </div>
    </div>

    <!-- ××•×“×œ ×“×™×œ××” -->
    <div id="dilemmaModal" class="dilemma-modal" style="display: none;">
        <div class="dilemma-content">
            <h3 class="dilemma-title">ğŸš¨ ×“×™×œ××” ×”× ×“×¡×™×ª!</h3>
            <div id="dilemmaContent">
                <!-- ×ª×•×›×Ÿ ×”×“×™×œ××” ×™×™×‘× ×” ×‘-JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // × ×ª×•× ×™ ×”××©×—×§
        let players = [
            { id: 1, name: '××”× ×“×¡ 1', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-1' },
            { id: 2, name: '××”× ×“×¡×ª 2', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-2' },
            { id: 3, name: '××”× ×“×¡ 3', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-3' },
            { id: 4, name: '××”× ×“×¡×ª 4', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-4' }
        ];

        let currentPlayer = 0;
        let diceValue = 1;
        let gameLog = [];
        let bonusTurn = false;
        let selectedCard = null;
        let currentDilemma = null;
        let showHint = false;
        let answerFeedback = null;
        let explanation = '';

        const boardPositions = 25;
        const dilemmaSquares = [2, 4, 6, 8, 10, 12, 15, 17, 19, 22];

        const knowledgeCards = [
            { id: 1, type: 'basic', name: '×—×•×§×™ × ×™×•×˜×•×Ÿ', description: '×—×•×§ ×”×ª× ×•×¢×” ×”×¨××©×•×Ÿ, ×”×©× ×™ ×•×”×©×œ×™×©×™', icon: 'ğŸ”¬', hint: '×—×©×‘×• ×¢×œ ××” ×§×•×¨×” ×›×©××ª× ×“×•×—×¤×™× ××©×”×• ×—×–×§ - ×”×•× ×“×•×—×£ ××ª×›× ×‘×—×–×¨×”. ×–×” ×¢×•×–×¨ ×‘×¨×§×˜×•×ª!' },
            { id: 2, type: 'basic', name: '××”×™×¨×•×ª ×•×ª××•×¦×”', description: '×›××” ××”×¨ ×–×–×™× ×•×›××” ××”×¨ ××ª×—×™×œ×™× ×œ×–×•×–', icon: 'âš¡', hint: '×›××• ×¨×›×‘ ×©×××™×¥ - ×›×›×œ ×©×™×© ×™×•×ª×¨ ×›×•×—, ×›×š ×™×•×ª×¨ ××”×¨ ××’×™×¢×™× ×œ××”×™×¨×•×ª ×’×‘×•×”×”' },
            { id: 3, type: 'basic', name: '×›×•×— ×›×‘×™×“×”', description: '×”×›×•×— ×©××•×©×š ×—×¤×¦×™× ×œ××˜×”', icon: 'ğŸŒ', hint: '×œ××” ×ª×¤×•×— × ×•×¤×œ ××”×¢×¥? ××•×ª×• ×›×•×— ×¢×•×‘×“ ×¢×œ ×”×—×œ×œ×™×ª - ×¨×§ ×©×‘×¦×“×§ ×”×•× ×”×¨×‘×” ×™×•×ª×¨ ×—×–×§!' },
            { id: 4, type: 'tech', name: '×× ×•×¢×™ ×¨×§×˜×”', description: '×× ×•×¢×™× ×©×™×•×¦×¨×™× ×“×—×£ ×—×–×§ ×××“', icon: 'ğŸš€', hint: '×›××• ×‘×œ×•×Ÿ ×©××©×—×¨×¨×™× - ×”×’×–×™× ×™×•×¦××™× ×‘×›×™×•×•×Ÿ ××—×“ ×•×”×‘×œ×•×Ÿ ×˜×¡ ×œ×›×™×•×•×Ÿ ×”×©× ×™' },
            { id: 5, type: 'tech', name: '×—×œ×™×¤×•×ª ×”×’× ×”', description: '×‘×’×“×™× ××™×•×—×“×™× ×©××’× ×™× ××—×•× ×•×§×•×¨', icon: 'ğŸ›¡ï¸', hint: '×›××• ××¢×™×œ ×—×•×¨×£ ××™×•×—×“ ×©××’×Ÿ ×’× ××—×•× ×§×™×¦×•× ×™ ×•×’× ××§×•×¨ - ×¨×§ ×”×¨×‘×” ×™×•×ª×¨ ×—×–×§!' },
            { id: 6, type: 'tech', name: '××—×©×‘×™ × ×™×•×•×˜', description: '××—×©×‘×™× ×©×¢×•×–×¨×™× ×œ××¦×•× ××ª ×”×“×¨×š', icon: 'ğŸ§­', hint: '×›××• GPS ×‘××›×•× ×™×ª, ×¨×§ ×©×–×” ×¢×•×‘×“ ×‘×—×œ×œ ×•××—×©×‘ ××™×š ×œ×”×’×™×¢ ×‘×™×Ÿ ×›×•×›×‘×™ ×”×œ×›×ª' },
            { id: 7, type: 'coop', name: '××›×©×™×¨ ×§×©×¨', description: '×“×™×‘×•×¨ ×‘×™×Ÿ ×—×‘×¨×™ ×”×¦×•×•×ª', icon: 'ğŸ“¡', hint: '×›××• ×˜×œ×¤×•×Ÿ, ×¨×§ ×©×–×” ×¢×•×‘×“ ×‘×—×œ×œ ×•×¢×•×–×¨ ×œ×›×œ ×”×¦×•×•×ª ×œ×¢×‘×•×“ ×™×—×“ ×‘×–××Ÿ ×××ª' },
            { id: 8, type: 'coop', name: '×¢×‘×•×“×ª ×¦×•×•×ª', description: '×©×™×ª×•×£ ×¤×¢×•×œ×” ×‘×™×Ÿ ×›××” ×× ×©×™×', icon: 'ğŸ‘¥', hint: '×›××• ×‘×¡×¤×•×¨×˜ - ×›×©×›×œ ×”×—×‘×¨×™× ×¢×•×‘×“×™× ×™×—×“, ×”× ×™×›×•×œ×™× ×œ×”×©×™×’ ×“×‘×¨×™× ×©××£ ××—×“ ×œ× ×™×›×•×œ ×œ×‘×“' }
        ];

        const dilemmaCards = [
            { id: 1, title: '×”×—×œ×œ×™×ª × ×”×™×™×ª ×—××” ××“×™!', description: '×›×©×”×—×œ×œ×™×ª ×¢×•×‘×¨×ª ×‘××˜××•×¡×¤×™×¨×” ×©×œ ×¦×“×§, ×”×™× × ×”×™×™×ª ×—××” ×›××• ×ª× ×•×¨. ××™×š × ×’×Ÿ ×¢×œ×™×”?', requiredTypes: ['basic', 'tech'], difficulty: 1 },
            { id: 2, title: '×¨×•×—×•×ª ×—×–×§×•×ª ×“×•×—×¤×•×ª ××•×ª× ×•!', description: '×™×© ×¨×•×—×•×ª ×©×œ 500 ×§×/×© ×©×“×•×—×¤×•×ª ××ª ×”×—×œ×œ×™×ª ×”×¦×™×“×”. ××™×š × ×©××•×¨ ×¢×œ ×›×™×•×•×Ÿ × ×›×•×Ÿ?', requiredTypes: ['basic', 'coop'], difficulty: 2 },
            { id: 3, title: '××™×Ÿ ××¡×¤×™×§ ×“×œ×§!', description: '×›×•×— ×”×›×‘×™×“×” ×©×œ ×¦×“×§ ×—×–×§ ×¤×™ 2.5 ××›×“×•×¨ ×”××¨×¥. ×”×× ×•×¢×™× ×©×œ× ×• ×¦×¨×™×›×™× ×™×•×ª×¨ ×“×œ×§ ××”×¦×¤×•×™.', requiredTypes: ['basic', 'tech'], difficulty: 2 },
            { id: 4, title: '×”××—×©×‘×™× ××ª×§×œ×§×œ×™×!', description: '×”×©×“×” ×”××’× ×˜×™ ×”×¢× ×§ ×©×œ ×¦×“×§ ×’×•×¨× ×œ××—×©×‘×™× ×©×œ× ×• ×œ×”×©×ª×’×¢. ××™×š × ×¤×ª×•×¨ ××ª ×–×”?', requiredTypes: ['tech', 'coop'], difficulty: 2 },
            { id: 5, title: '××™×š × ××¦× ××ª ×”×“×¨×š ×”× ×›×•× ×”?', description: '×¦×“×§ ××•×§×£ ×‘-79 ×™×¨×—×™×! ××™×š × ×—×©×‘ ××¡×œ×•×œ ×©×œ× ×™×ª× ×’×© ×‘×”×?', requiredTypes: ['basic', 'tech'], difficulty: 1 },
            { id: 6, title: '×”×¦×•×•×ª ×¤×–×•×¨ ×‘××§×•××•×ª ×©×•× ×™×!', description: '×—×œ×§ ××”×¦×•×•×ª ×‘×ª×—× ×ª ×”×—×œ×œ ×•×—×œ×§ ×‘×—×œ×œ×™×ª. ××™×š × ×ª×× ×‘×™× ×™×”×?', requiredTypes: ['coop'], difficulty: 1 },
            { id: 7, title: '×”×—×œ×œ×™×ª ×¨×•×¢×“×ª ×××“!', description: '×”×¨×¢×™×“×•×ª ×—×–×§×•×ª ×›×œ ×›×š ×©×§×©×” ×œ×©×œ×•×˜ ×‘×—×œ×œ×™×ª. ××” × ×¢×©×”?', requiredTypes: ['basic', 'tech'], difficulty: 2 },
            { id: 8, title: '×”×’×–×™× ×”×¨×¢×™×œ×™× ×©×œ ×¦×“×§!', description: '×”××˜××•×¡×¤×™×¨×” ×©×œ ×¦×“×§ ××›×™×œ×” ×’×–×™× ××¡×•×›× ×™× ×©×™×›×•×œ×™× ×œ×¤×’×•×¢ ×‘×—×œ×œ×™×ª.', requiredTypes: ['tech'], difficulty: 1 },
            { id: 9, title: '××™×š × ×“×¢ ×©×”×’×¢× ×• ×œ××”×™×¨×•×ª × ×›×•× ×”?', description: '×× ×—× ×• ×¦×¨×™×›×™× ×œ×”×’×™×¢ ×œ××”×™×¨×•×ª ×©×œ 60 ×§×/×© ×›×“×™ ×œ×‘×¨×•×— ××›×•×— ×”×›×‘×™×“×” ×©×œ ×¦×“×§.', requiredTypes: ['basic', 'tech'], difficulty: 2 },
            { id: 10, title: '××‘×“× ×• ×§×©×¨ ×¢× ×›×“×•×¨ ×”××¨×¥!', description: '×× ×—× ×• ×›×œ ×›×š ×¨×—×•×§ ××›×“×•×¨ ×”××¨×¥ ×©××™×Ÿ ×œ× ×• ×§×©×¨ ×¨×“×™×•. ××” × ×¢×©×”?', requiredTypes: ['coop', 'tech'], difficulty: 2 }
        ];

        // ×‘× ×™×™×ª ×”×œ×•×—
        function buildBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            for (let row = 0; row < 5; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'board-row';

                for (let col = 0; col < 5; col++) {
                    const position = row * 5 + (row % 2 === 0 ? col : 4 - col);
                    if (position >= boardPositions) continue;

                    const square = document.createElement('div');
                    square.className = 'board-square';

                    // ×§×‘×™×¢×ª ×¡×•×’ ×”××©×‘×¦×ª
                    if (position === 0) {
                        square.classList.add('square-start');
                    } else if (position === boardPositions - 1) {
                        square.classList.add('square-end');
                    } else if (dilemmaSquares.includes(position)) {
                        square.classList.add('square-dilemma');
                    } else {
                        square.classList.add('square-normal');
                    }

                    square.innerHTML = `<span>${position}</span>`;

                    // ×”×•×¡×¤×ª ××™×™×§×•× ×™×
                    if (dilemmaSquares.includes(position)) {
                        square.innerHTML += '<span class="warning-icon">âš ï¸</span>';
                    } else if (position === 0) {
                        square.innerHTML += '<span class="warning-icon">ğŸ</span>';
                    } else if (position === boardPositions - 1) {
                        square.innerHTML += '<span class="warning-icon">ğŸ¯</span>';
                    }

                    // ×”×•×¡×¤×ª ×©×—×§× ×™×
                    players.forEach(player => {
                        if (player.position === position) {
                            const piece = document.createElement('div');
                            piece.className = `player-piece ${player.color}`;
                            square.appendChild(piece);
                        }
                    });

                    rowDiv.appendChild(square);
                }
                board.appendChild(rowDiv);
            }
        }

        // ×¢×“×›×•×Ÿ ××™×“×¢ ×©×—×§× ×™×
        function updatePlayersInfo() {
            const playersInfo = document.getElementById('playersInfo');
            playersInfo.innerHTML = '';

            players.forEach((player, index) => {
                const card = document.createElement('div');
                card.className = `player-card ${index === currentPlayer ? 'player-active' : ''}`;
                
                const colorMap = {
                    'player-1': '#3b82f6',
                    'player-2': '#ffffff',
                    'player-3': '#22c55e',
                    'player-4': '#a855f7'
                };

                card.innerHTML = `
                    <div class="player-color" style="background-color: ${colorMap[player.color]}; ${player.color === 'player-2' ? 'border: 2px solid #4b5563;' : ''}"></div>
                    <h3 style="font-weight: bold; margin-bottom: 8px;">${player.name}</h3>
                    <div style="font-size: 0.9rem;">
                        <div style="margin-bottom: 4px;">ğŸ“ ××™×§×•×: ${player.position}</div>
                        <div style="margin-bottom: 4px;">âš¡ ×× ×¨×’×™×”: ${player.energy}</div>
                        <div style="margin-bottom: 4px;">ğŸ§  ×™×“×¢: ${player.knowledge}</div>
                        <div>ğŸ† × ×™×§×•×“: <span style="color: #fde047; font-weight: bold;">${player.score}</span></div>
                    </div>
                `;
                playersInfo.appendChild(card);
            });
        }

        // ×¢×“×›×•×Ÿ ×œ×•×— × ×™×§×•×“
        function updateScoreBoard() {
            const scoreBoard = document.getElementById('scoreBoard');
            scoreBoard.innerHTML = '';

            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);

            sortedPlayers.forEach((player, index) => {
                const card = document.createElement('div');
                card.className = `score-card ${index === 0 ? 'score-leader' : ''}`;
                
                const colorMap = {
                    'player-1': '#3b82f6',
                    'player-2': '#ffffff',
                    'player-3': '#22c55e',
                    'player-4': '#a855f7'
                };

                card.innerHTML = `
                    <div class="player-color" style="background-color: ${colorMap[player.color]}; ${player.color === 'player-2' ? 'border: 2px solid #4b5563;' : ''} margin: 0 auto 8px auto;"></div>
                    <div style="font-weight: bold; font-size: 0.9rem; margin-bottom: 4px;">${player.name}</div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #fde047; margin-bottom: 4px;">${player.score}</div>
                    ${index === 0 ? '<div style="font-size: 0.8rem; color: #fde047;">ğŸ‘‘ ××•×‘×™×œ</div>' : ''}
                    <div style="font-size: 0.8rem; color: #d1d5db;">××™×§×•×: ${player.position}</div>
                `;
                scoreBoard.appendChild(card);
            });
        }

        // ×¢×“×›×•×Ÿ ×¤×§×“×™×
        function updateControls() {
            const controls = document.getElementById('gameControls');
            
            controls.innerHTML = `
                <div class="current-player">
                    ×ª×•×¨ ×©×œ: <span style="color: #fde047; font-weight: bold;">${players[currentPlayer].name}</span>
                </div>
                ${bonusTurn ? '<p style="color: #86efac; font-weight: bold; margin-bottom: 10px;">ğŸ‰ ×ª×•×¨ ×‘×•× ×•×¡! ×”×¦×œ×—×ª ×œ×¤×ª×•×¨ ××ª ×”×“×™×œ××”!</p>' : ''}
                <p style="color: #d1d5db; margin-bottom: 16px; font-size: 0.9rem;">
                    ${bonusTurn ? '×”×ª×•×¨ ×”×‘×•× ×•×¡ ×©×œ×š - ×”×˜×™×œ×™ ×©×•×‘ ×§×•×‘×™×™×”!' : '×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×›×“×™ ×œ×”×˜×™×œ ×§×•×‘×™×™×” ×•×œ×–×•×– ×¢×œ ×”×œ×•×—'}
                </p>
                <button onclick="handlePlayerTurn()" class="game-button ${bonusTurn ? 'bonus-button' : ''}" ${currentDilemma ? 'disabled' : ''}>
                    ${bonusTurn ? 'ğŸ²ğŸ‰ ×”×˜×œ ×§×•×‘×™×™×” - ×ª×•×¨ ×‘×•× ×•×¡!' : 'ğŸ² ×”×˜×œ ×§×•×‘×™×™×” ×•×–×•×–'}
                </button>
                <p style="color: #9ca3af; margin-top: 8px; font-size: 0.8rem;">×¢×¨×š ×§×•×‘×™×™×” ××—×¨×•×Ÿ: ${diceValue}</p>
            `;
        }

        // ×”×˜×œ×ª ×§×•×‘×™×™×” ×•×ª× ×•×¢×”
        function handlePlayerTurn() {
            if (currentDilemma) return;

            diceValue = Math.floor(Math.random() * 6) + 1;
            addLog(`${players[currentPlayer].name} ×”×˜×™×œ ×§×•×‘×™×™×” ×•×§×™×‘×œ: ${diceValue}`);
            
            movePlayer(diceValue);

            if (bonusTurn) {
                bonusTurn = false;
                setTimeout(() => {
                    currentPlayer = (currentPlayer + 1) % players.length;
                    updateUI();
                }, 1000);
            } else {
                setTimeout(() => {
                    if (!currentDilemma) {
                        currentPlayer = (currentPlayer + 1) % players.length;
                        updateUI();
                    }
                }, 1000);
            }
        }

        // ×ª× ×•×¢×ª ×©×—×§×Ÿ
        function movePlayer(steps) {
            const player = players[currentPlayer];
            const newPosition = Math.min(player.position + steps, boardPositions - 1);
            player.position = newPosition;

            // ×‘×“×™×§×ª ×“×™×œ××”
            if (dilemmaSquares.includes(newPosition)) {
                const randomDilemma = dilemmaCards[Math.floor(Math.random() * dilemmaCards.length)];
                currentDilemma = randomDilemma;
                showDilemma();
                addLog(`${player.name} × ×ª×§×œ ×‘×“×™×œ××”: ${randomDilemma.title}`);
            }

            // ×‘×“×™×§×ª × ×™×¦×—×•×Ÿ
            if (newPosition >= boardPositions - 1) {
                addLog(`ğŸ‰ ${player.name} ×”×¦×œ×™×— ×œ×‘×¨×•×— ××›×•×›×‘ ×¦×“×§ ×•× ×¦×— ×‘××©×—×§!`);
                player.score += 100;
            }

            updateUI();
        }

        // ×”×¦×’×ª ×“×™×œ××”
        function showDilemma() {
            const modal = document.getElementById('dilemmaModal');
            const content = document.getElementById('dilemmaContent');
            
            selectedCard = null;
            showHint = false;
            explanation = '';
            answerFeedback = null;

            content.innerHTML = `
                <h4 style="font-size: 1.1rem; font-weight: bold; margin-bottom: 8px;">${currentDilemma.title}</h4>
                <p style="margin-bottom: 16px; color: #e5e7eb;">${currentDilemma.description}</p>
                <p style="font-size: 0.9rem; color: #d1d5db; margin-bottom: 16px;">
                    ×“×¨×•×©×™× ×§×œ×¤×™× ××¡×•×’: <strong>${currentDilemma.requiredTypes.join(', ')}</strong> | 
                    ×§×•×©×™: ${'â­'.repeat(currentDilemma.difficulty)}
                </p>
                
                <div id="feedbackArea"></div>
                
                <div id="cardSelection">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <label style="font-weight: bold;">×‘×—×¨ ×§×œ×£ ×œ×¤×ª×¨×•×Ÿ:</label>
                        <button onclick="toggleHint()" style="background: #ea580c; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 0.9rem; cursor: pointer;">
                            ğŸ’¡ ${showHint ? '×”×¡×ª×¨ ×¨××–' : '×¨××– (-1 × ×§×•×“×”)'}
                        </button>
                    </div>
                    
                    <div class="cards-grid" id="cardsGrid">
                        ${knowledgeCards.map(card => `
                            <div>
                                <button onclick="selectCard(${card.id})" class="card-button" id="card-${card.id}">
                                    <div style="font-weight: bold; margin-bottom: 4px;">${card.icon} ${card.name}</div>
                                    <div style="font-size: 0.8rem; color: #d1d5db;">${card.type}</div>
                                    <div style="font-size: 0.8rem; color: #9ca3af; margin-top: 4px;">${card.description}</div>
                                </button>
                                <div id="hint-${card.id}" style="display: none;"></div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin: 16px 0;">
                        <label style="font-weight: bold; display: block; margin-bottom: 8px;">×”×¡×‘×¨ ××ª ×”×¤×ª×¨×•×Ÿ ×©×œ×š (×œ×¤×—×•×ª 30 ×ª×•×•×™×):</label>
                        <textarea id="explanationText" placeholder="×œ××©×œ: ×× ×™ ×‘×•×—×¨ ×§×œ×£ '×—×œ×™×¤×•×ª ×”×’× ×”' ×›×™ ×”×Ÿ ××’× ×•×ª ×¢×œ ×”×—×œ×œ×™×ª ××¤× ×™ ×”×—×•× ×”×§×™×¦×•× ×™..." onInput="updateExplanation()"></textarea>
                        <div style="font-size: 0.8rem; color: #9ca3af; margin-top: 4px;" id="charCount">0/30 ×ª×•×•×™× ××™× ×™××•×</div>
                    </div>
                    
                    <button onclick="solveDilemma()" id="solveButton" class="game-button" style="background: #16a34a;" disabled>
                        âœ… ×¤×ª×•×¨ ××ª ×”×“×™×œ××”
                    </button>
                </div>
            `;

            modal.style.display = 'flex';
        }

        // ×‘×—×™×¨×ª ×§×œ×£
        function selectCard(cardId) {
            selectedCard = cardId;
            
            // ×¢×“×›×•×Ÿ ×•×™×–×•××œ×™
            knowledgeCards.forEach(card => {
                const cardElement = document.getElementById(`card-${card.id}`);
                if (card.id === cardId) {
                    cardElement.classList.add('card-selected');
                } else {
                    cardElement.classList.remove('card-selected');
                }
            });

            // ×”×¦×’×ª ×¨××– ×× × ×“×¨×©
            updateHintDisplay();
            updateSolveButton();
        }

        // ×”×—×œ×¤×ª ×¨××–
        function toggleHint() {
            showHint = !showHint;
            updateHintDisplay();
            
            // ×¢×“×›×•×Ÿ ×›×¤×ª×•×¨ ×”×¨××–
            const hintButton = document.querySelector('[onclick="toggleHint()"]');
            hintButton.textContent = `ğŸ’¡ ${showHint ? '×”×¡×ª×¨ ×¨××–' : '×¨××– (-1 × ×§×•×“×”)'}`;
        }

        // ×¢×“×›×•×Ÿ ×”×¦×’×ª ×¨××–
        function updateHintDisplay() {
            knowledgeCards.forEach(card => {
                const hintElement = document.getElementById(`hint-${card.id}`);
                if (showHint && selectedCard === card.id) {
                    hintElement.style.display = 'block';
                    hintElement.innerHTML = `<div class="hint-box"><strong>ğŸ’¡ ×¨××–:</strong> ${card.hint}</div>`;
                } else {
                    hintElement.style.display = 'none';
                }
            });
        }

        // ×¢×“×›×•×Ÿ ×”×¡×‘×¨
        function updateExplanation() {
            explanation = document.getElementById('explanationText').value;
            document.getElementById('charCount').textContent = `${explanation.length}/30 ×ª×•×•×™× ××™× ×™××•×`;
            updateSolveButton();
        }

        // ×¢×“×›×•×Ÿ ×›×¤×ª×•×¨ ×¤×ª×¨×•×Ÿ
        function updateSolveButton() {
            const button = document.getElementById('solveButton');
            button.disabled = !selectedCard || explanation.length < 30;
        }

        // ×¤×ª×¨×•×Ÿ ×“×™×œ××”
        function solveDilemma() {
            if (!selectedCard || explanation.length < 30) {
                alert('× × ×œ×‘×—×•×¨ ×§×œ×£ ×•×œ×›×ª×•×‘ ×”×¡×‘×¨!');
                return;
            }

            const feedback = evaluateAnswer();
            showFeedback(feedback);

            let bonusSteps = 0;
            let points = 0;
            let hintPenalty = showHint ? 1 : 0;

            if (feedback.status === 'correct') {
                bonusSteps = 3;
                points = (currentDilemma.difficulty * 10) - hintPenalty;
            } else if (feedback.status === 'partial') {
                bonusSteps = 1;
                points = 5 - hintPenalty;
            } else {
                points = 0;
                bonusSteps = 0;
            }

            addLog(feedback.message);
            if (bonusSteps > 0) {
                addLog(`${players[currentPlayer].name} ×–×•×›×” ×‘-${bonusSteps} ×¦×¢×“×™ ×‘×•× ×•×¡ ×•-${points} × ×§×•×“×•×ª!`);
            }

            // ×¢×“×›×•×Ÿ × ×§×•×“×•×ª ×”×©×—×§×Ÿ
            players[currentPlayer].score += points;
            players[currentPlayer].knowledge = Math.max(0, players[currentPlayer].knowledge - 1);

            // ×”×ª×§×“××•×ª × ×•×¡×¤×ª
            if (bonusSteps > 0) {
                setTimeout(() => {
                    movePlayer(bonusSteps);
                    bonusTurn = true;
                    addLog(`${players[currentPlayer].name} ××§×‘×œ ×ª×•×¨ ×‘×•× ×•×¡! ×”×˜×™×œ×™ ×©×•×‘ ×§×•×‘×™×™×”!`);
                    closeDilemma();
                }, 2000);
            } else {
                setTimeout(() => {
                    currentPlayer = (currentPlayer + 1) % players.length;
                    closeDilemma();
                }, 2000);
            }
        }

        // ×”×¢×¨×›×ª ×”×ª×©×•×‘×”
        function evaluateAnswer() {
            const card = knowledgeCards.find(c => c.id === selectedCard);
            const explanationWords = explanation.trim().toLowerCase().split(' ');

            const relevantKeywords = {
                '×”×—×œ×œ×™×ª × ×”×™×™×ª ×—××” ××“×™!': ['×—×•×', '×”×’× ×”', '××’×Ÿ', '×—×œ×™×¤×”', '×‘×™×“×•×“'],
                '×¨×•×—×•×ª ×—×–×§×•×ª ×“×•×—×¤×•×ª ××•×ª× ×•!': ['×›×™×•×•×Ÿ', '× ×™×•×•×˜', '×©×œ×™×˜×”', '×›×•×—', '×¦×•×•×ª'],
                '××™×Ÿ ××¡×¤×™×§ ×“×œ×§!': ['×›×•×—', '×× ×•×¢', '×“×œ×§', '×—×–×§', '×ª××•×¦×”'],
                '×”××—×©×‘×™× ××ª×§×œ×§×œ×™×!': ['××’×Ÿ', '×”×’× ×”', '×ª×™×§×•×Ÿ', '×¦×•×•×ª', '×’×™×‘×•×™'],
                '××™×š × ××¦× ××ª ×”×“×¨×š ×”× ×›×•× ×”?': ['× ×™×•×•×˜', '××—×©×‘', '×—×™×©×•×‘', '××¡×œ×•×œ'],
                '×”×¦×•×•×ª ×¤×–×•×¨ ×‘××§×•××•×ª ×©×•× ×™×!': ['×§×©×¨', '×ª×§×©×•×¨×ª', '×¨×“×™×•', '×¦×•×•×ª', '×ª×™××•×'],
                '×”×—×œ×œ×™×ª ×¨×•×¢×“×ª ×××“!': ['×©×œ×™×˜×”', '×™×¦×™×‘×•×ª', '×›×•×—', '××™×–×•×Ÿ'],
                '×”×’×–×™× ×”×¨×¢×™×œ×™× ×©×œ ×¦×“×§!': ['×”×’× ×”', '××’×Ÿ', '×—×œ×™×¤×”', '×‘×˜×™×—×•×ª'],
                '××™×š × ×“×¢ ×©×”×’×¢× ×• ×œ××”×™×¨×•×ª × ×›×•× ×”?': ['××”×™×¨×•×ª', '××“×™×“×”', '××—×©×‘', '×—×™×©×•×‘'],
                '××‘×“× ×• ×§×©×¨ ×¢× ×›×“×•×¨ ×”××¨×¥!': ['×§×©×¨', '×ª×§×©×•×¨×ª', '×¨×“×™×•', '×× ×˜× ×”']
            };

            const keywords = relevantKeywords[currentDilemma.title] || [];
            const hasRelevantWords = keywords.some(keyword => 
                explanationWords.some(word => word.includes(keyword))
            );

            const isCorrectType = currentDilemma.requiredTypes.includes(card.type);
            const isLongEnough = explanation.length >= 30;

            if (isCorrectType && hasRelevantWords && isLongEnough) {
                return { status: 'correct', message: 'âœ… ×ª×©×•×‘×” ××¦×•×™× ×ª! ×”×¡×‘×¨×ª × ×›×•×Ÿ ××™×š ×”×§×œ×£ ×¤×•×ª×¨ ××ª ×”×‘×¢×™×”.' };
            } else if (isCorrectType && isLongEnough) {
                return { status: 'partial', message: 'âš¡ ×ª×©×•×‘×” ×˜×•×‘×”! ×”×§×œ×£ ××ª××™× ××‘×œ ×”×”×¡×‘×¨ ×™×›×•×œ ×œ×”×™×•×ª ×™×•×ª×¨ ×¡×¤×¦×™×¤×™ ×œ×‘×¢×™×”.' };
            } else if (isCorrectType) {
                return { status: 'partial', message: 'âš¡ ×›×™×•×•×Ÿ × ×›×•×Ÿ! × ×¡×” ×œ×”×¨×—×™×‘ ××ª ×”×”×¡×‘×¨ - ××™×š ×‘×“×™×•×§ ×”×§×œ×£ ×¢×•×–×¨?' };
            } else {
                return { status: 'wrong', message: 'âŒ ×”×§×œ×£ ×œ× ×××© ××ª××™× ×œ×‘×¢×™×” ×”×–×•. × ×¡×” ×œ×—×©×•×‘ ×¢×œ ×§×œ×£ ××—×¨ ××• ×§×— ×¨××–!' };
            }
        }

        // ×”×¦×’×ª ××©×•×‘
        function showFeedback(feedback) {
            const feedbackArea = document.getElementById('feedbackArea');
            const cardSelection = document.getElementById('cardSelection');
            
            let feedbackClass = 'feedback-wrong';
            if (feedback.status === 'correct') feedbackClass = 'feedback-correct';
            else if (feedback.status === 'partial') feedbackClass = 'feedback-partial';
            
            feedbackArea.innerHTML = `<div class="feedback-box ${feedbackClass}">${feedback.message}</div>`;
            cardSelection.style.display = 'none';
        }

        // ×¡×’×™×¨×ª ×“×™×œ××”
        function closeDilemma() {
            setTimeout(() => {
                document.getElementById('dilemmaModal').style.display = 'none';
                currentDilemma = null;
                updateUI();
            }, 1000);
        }

        // ×”×•×¡×¤×” ×œ×™×•××Ÿ
        function addLog(message) {
            gameLog.push(message);
            if (gameLog.length > 5) gameLog.shift();
            
            const logElement = document.getElementById('gameLog');
            logElement.innerHTML = gameLog.map(entry => 
                `<div class="log-entry">${entry}</div>`
            ).join('');
        }

        // ××™×¤×•×¡ ××©×—×§
        function resetGame() {
            players = [
                { id: 1, name: '××”× ×“×¡ 1', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-1' },
                { id: 2, name: '××”× ×“×¡×ª 2', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-2' },
                { id: 3, name: '××”× ×“×¡ 3', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-3' },
                { id: 4, name: '××”× ×“×¡×ª 4', position: 0, energy: 10, parts: 5, knowledge: 3, score: 0, color: 'player-4' }
            ];
            currentPlayer = 0;
            bonusTurn = false;
            gameLog = [];
            currentDilemma = null;
            document.getElementById('dilemmaModal').style.display = 'none';
            
            addLog('××©×—×§ ×—×“×© ×”×ª×—×™×œ!');
            updateUI();
        }

        // ×¢×“×›×•×Ÿ ×××©×§ ××©×ª××©
        function updateUI() {
            buildBoard();
            updatePlayersInfo();
            updateScoreBoard();
            updateControls();
        }

        // ××ª×—×•×œ ×”××©×—×§
        updateUI();
        addLog('×”××©×—×§ ×”×ª×—×™×œ! ×‘×”×¦×œ×—×”!');
    </script>
</body>
</html>
